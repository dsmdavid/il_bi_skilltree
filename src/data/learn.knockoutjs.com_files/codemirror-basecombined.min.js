var CodeMirrorConfig=window.CodeMirrorConfig||{},CodeMirror=function(){function c(a,b){for(var d in b)a.hasOwnProperty(d)||(a[d]=b[d])}function g(a,b){for(var d=0;d<a.length;d++)b(a[d])}function e(a){return document.createElementNS&&document.documentElement.namespaceURI!==null?document.createElementNS("http://www.w3.org/1999/xhtml",a):document.createElement(a)}function f(a,b){var d=e("div"),k=e("div");d.style.position="absolute";d.style.height="100%";if(d.style.setExpression)try{d.style.setExpression("height",
"this.previousSibling.offsetHeight + 'px'")}catch(p){}d.style.top="0px";d.style.left="0px";d.style.overflow="hidden";a.appendChild(d);k.className="CodeMirror-line-numbers";d.appendChild(k);k.innerHTML="<div>"+b+"</div>";return d}function j(a){if(typeof a.parserfile=="string")a.parserfile=[a.parserfile];if(typeof a.basefiles=="string")a.basefiles=[a.basefiles];if(typeof a.stylesheet=="string")a.stylesheet=[a.stylesheet];var b=' spellcheck="'+(a.disableSpellcheck?"false":"true")+'"',d=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html'+
b+"><head>"];d.push('<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>');var k=a.noScriptCaching?"?nocache="+(new Date).getTime().toString(16):"";g(a.stylesheet,function(a){d.push('<link rel="stylesheet" type="text/css" href="'+a+k+'"/>')});g(a.basefiles.concat(a.parserfile),function(b){/^https?:/.test(b)||(b=a.path+b);d.push('<script type="text/javascript" src="'+b+k+'"><\/script>')});d.push('</head><body style="border-width: 0;" class="editbox"'+b+"></body></html>");return d.join("")}
function l(a,b){this.options=b=b||{};c(b,CodeMirrorConfig);if(b.dumbTabs)b.tabMode="spaces";else if(b.normalTab)b.tabMode="default";if(b.cursorActivity)b.onCursorActivity=b.cursorActivity;var d=this.frame=e("iframe");if(b.iframeClass)d.className=b.iframeClass;d.frameBorder=0;d.style.border="0";d.style.width="100%";d.style.height="100%";d.style.display="block";var k=this.wrapping=e("div");k.className="CodeMirror-wrapping";k.style.width=b.width;k.style.height=b.height=="dynamic"?b.minHeight+"px":b.height;
var p=this.textareaHack=e("textarea");k.appendChild(p);p.style.position="absolute";p.style.left="-10000px";p.style.width="10px";p.tabIndex=1E5;d.CodeMirror=this;b.domain&&n?(this.html=j(b),d.src="javascript:(function(){document.open();"+(b.domain?'document.domain="'+b.domain+'";':"")+"document.write(window.frameElement.CodeMirror.html);document.close();})()"):d.src="javascript:;";a.appendChild?a.appendChild(k):a(k);k.appendChild(d);if(b.lineNumbers)this.lineNumbers=f(k,b.firstLineNumber);this.win=
d.contentWindow;if(!b.domain||!n)this.win.document.open(),this.win.document.write(j(b)),this.win.document.close()}c(CodeMirrorConfig,{stylesheet:[],path:"",parserfile:[],basefiles:["util.js","stringstream.js","select.js","undo.js","editor.js","tokenize.js"],iframeClass:null,passDelay:200,passTime:50,lineNumberDelay:200,lineNumberTime:50,continuousScanning:!1,saveFunction:null,onLoad:null,onChange:null,undoDepth:50,undoDelay:800,disableSpellcheck:!0,textWrapping:!0,readOnly:!1,width:"",height:"300px",
minHeight:100,onDynamicHeightChange:null,autoMatchParens:!1,markParen:null,unmarkParen:null,parserConfig:null,tabMode:"indent",enterMode:"indent",electricChars:!0,reindentOnLoad:!1,activeTokens:null,onCursorActivity:null,lineNumbers:!1,firstLineNumber:1,onLineNumberClick:null,indentUnit:2,domain:null,noScriptCaching:!1,incrementalLoading:!1});var n=document.selection&&window.ActiveXObject&&/MSIE/.test(navigator.userAgent);l.prototype={init:function(){this.options.initCallback&&this.options.initCallback(this);
if(this.options.onLoad)this.options.onLoad(this);this.options.lineNumbers&&this.activateLineNumbers();this.options.reindentOnLoad&&this.reindent();this.options.height=="dynamic"&&this.setDynamicHeight()},getCode:function(){return this.editor.getCode()},setCode:function(a){this.editor.importCode(a)},selection:function(){this.focusIfIE();return this.editor.selectedText()},reindent:function(){this.editor.reindent()},reindentSelection:function(){this.focusIfIE();this.editor.reindentSelection(null)},focusIfIE:function(){this.win.select.ie_selection&&
document.activeElement!=this.frame&&this.focus()},focus:function(){this.win.focus();this.editor.selectionSnapshot&&this.win.select.setBookmark(this.win.document.body,this.editor.selectionSnapshot)},replaceSelection:function(a){this.focus();this.editor.replaceSelection(a);return!0},replaceChars:function(a,b,d){this.editor.replaceChars(a,b,d)},getSearchCursor:function(a,b,d){return this.editor.getSearchCursor(a,b,d)},undo:function(){this.editor.history.undo()},redo:function(){this.editor.history.redo()},
historySize:function(){return this.editor.history.historySize()},clearHistory:function(){this.editor.history.clear()},grabKeys:function(a,b){this.editor.grabKeys(a,b)},ungrabKeys:function(){this.editor.ungrabKeys()},setParser:function(a,b){this.editor.setParser(a,b)},setSpellcheck:function(a){this.win.document.body.spellcheck=a},setStylesheet:function(a){typeof a==="string"&&(a=[a]);for(var b={},d={},k=this.win.document.getElementsByTagName("link"),p=0,h;h=k[p];p++)if(h.rel.indexOf("stylesheet")!==
-1)for(var i=0;i<a.length;i++){var c=a[i];h.href.substring(h.href.length-c.length)===c&&(b[h.href]=!0,d[c]=!0)}for(p=0;h=k[p];p++)if(h.rel.indexOf("stylesheet")!==-1)h.disabled=!(h.href in b);for(i=0;i<a.length;i++)if(c=a[i],!(c in d))h=this.win.document.createElement("link"),h.rel="stylesheet",h.type="text/css",h.href=c,this.win.document.getElementsByTagName("head")[0].appendChild(h)},setTextWrapping:function(a){if(a!=this.options.textWrapping)this.win.document.body.style.whiteSpace=a?"":"nowrap",
this.options.textWrapping=a,this.lineNumbers&&(this.setLineNumbers(!1),this.setLineNumbers(!0))},setIndentUnit:function(a){this.win.indentUnit=a},setUndoDepth:function(a){this.editor.history.maxDepth=a},setTabMode:function(a){this.options.tabMode=a},setEnterMode:function(a){this.options.enterMode=a},setLineNumbers:function(a){if(a&&!this.lineNumbers)this.lineNumbers=f(this.wrapping,this.options.firstLineNumber),this.activateLineNumbers();else if(!a&&this.lineNumbers)this.wrapping.removeChild(this.lineNumbers),
this.wrapping.style.paddingLeft="",this.lineNumbers=null},cursorPosition:function(a){this.focusIfIE();return this.editor.cursorPosition(a)},firstLine:function(){return this.editor.firstLine()},lastLine:function(){return this.editor.lastLine()},nextLine:function(a){return this.editor.nextLine(a)},prevLine:function(a){return this.editor.prevLine(a)},lineContent:function(a){return this.editor.lineContent(a)},setLineContent:function(a,b){this.editor.setLineContent(a,b)},removeLine:function(a){this.editor.removeLine(a)},
insertIntoLine:function(a,b,d){this.editor.insertIntoLine(a,b,d)},selectLines:function(a,b,d,k){this.win.focus();this.editor.selectLines(a,b,d,k)},nthLine:function(a){for(var b=this.firstLine();a>1&&b!==!1;a--)b=this.nextLine(b);return b},lineNumber:function(a){for(var b=0;a!==!1;)b++,a=this.prevLine(a);return b},jumpToLine:function(a){typeof a=="number"&&(a=this.nthLine(a));this.selectLines(a,0);this.win.focus()},currentLine:function(){return this.lineNumber(this.cursorLine())},cursorLine:function(){return this.cursorPosition().line},
cursorCoords:function(a){return this.editor.cursorCoords(a)},activateLineNumbers:function(){function a(){if(h.offsetWidth!=0){for(var a=h;a.parentNode;a=a.parentNode);if(!q.parentNode||a!=document||!i.Editor){try{g()}catch(b){}clearInterval(j)}else if(q.offsetWidth!=n)n=q.offsetWidth,h.parentNode.style.paddingLeft=n+"px"}}function b(){q.scrollTop=s.scrollTop||c.documentElement.scrollTop||0}function d(a){var b=l.firstChild.offsetHeight;if(b!=0)for(var b=Math.ceil((50+Math.max(s.offsetHeight,Math.max(h.offsetHeight,
s.scrollHeight||0)))/b),k=l.childNodes.length;k<=b;k++){var d=e("div");d.appendChild(document.createTextNode(a?String(k+f.options.firstLineNumber):"\u00a0"));l.appendChild(d)}}function k(){function a(){d(!0);b()}f.updateNumbers=a;var k=i.addEventHandler(i,"scroll",b,!0),h=i.addEventHandler(i,"resize",a,!0);g=function(){k();h();if(f.updateNumbers==a)f.updateNumbers=null};a()}function p(){function a(b,k){q||(q=l.appendChild(e("div")));x&&x(q,k,b);o.push(q);o.push(b);j=q.offsetHeight+q.offsetTop;q=q.nextSibling}
function k(){for(var a=0;a<o.length;a+=2)o[a].innerHTML=o[a+1];o=[]}function h(){if(l.parentNode&&l.parentNode==f.lineNumbers){for(var d=(new Date).getTime()+f.options.lineNumberTime;m;){for(a(n++,m.previousSibling);m&&!i.isBR(m);m=m.nextSibling)for(var p=m.offsetTop+m.offsetHeight;l.offsetHeight&&p-3>j;){var c=j;a("&nbsp;");if(j<=c)break}if(m)m=m.nextSibling;if((new Date).getTime()>d){k();z=setTimeout(h,f.options.lineNumberDelay);return}}for(;q;)a(n++);k();b()}}function p(a){b();d(a);m=s.firstChild;
q=l.firstChild;j=0;n=f.options.firstLineNumber;h()}function c(){z&&clearTimeout(z);f.editor.allClean()?p():z=setTimeout(c,200)}var m,q,n,j,o=[],x=f.options.styleNumbers;p(!0);var z=null;f.updateNumbers=c;var D=i.addEventHandler(i,"scroll",b,!0),y=i.addEventHandler(i,"resize",c,!0);g=function(){z&&clearTimeout(z);if(f.updateNumbers==c)f.updateNumbers=null;D();y()}}var h=this.frame,i=h.contentWindow,c=i.document,s=c.body,q=this.lineNumbers,l=q.firstChild,f=this,n=null;q.onclick=function(a){var b=f.options.onLineNumberClick;
if(b){var a=(a||window.event).target||(a||window.event).srcElement,k=a==q?NaN:Number(a.innerHTML);isNaN(k)||b(k,a)}};var g=function(){};a();var j=setInterval(a,500);(this.options.textWrapping||this.options.styleNumbers?p:k)()},setDynamicHeight:function(){function a(){for(var a=0,d=p.lastChild,i;d&&k.isBR(d);)d.hackBR||a++,d=d.previousSibling;d?(h=d.offsetHeight,i=d.offsetTop+(1+a)*h):h&&(i=a*h);if(i&&(b.options.onDynamicHeightChange&&(i=b.options.onDynamicHeightChange(i)),i))b.wrapping.style.height=
Math.max(c+i,b.options.minHeight)+"px"}var b=this,d=b.options.onCursorActivity,k=b.win,p=k.document.body,h=null,i=null,c=2*b.frame.offsetTop;p.style.overflowY="hidden";k.document.documentElement.style.overflowY="hidden";this.frame.scrolling="no";setTimeout(a,300);b.options.onCursorActivity=function(b){d&&d(b);clearTimeout(i);i=setTimeout(a,100)}}};l.InvalidLineHandle={toString:function(){return"CodeMirror.InvalidLineHandle"}};l.replace=function(a){typeof a=="string"&&(a=document.getElementById(a));
return function(b){a.parentNode.replaceChild(b,a)}};l.fromTextArea=function(a,b){function d(){a.value=h.getCode()}typeof a=="string"&&(a=document.getElementById(a));b=b||{};if(a.style.width&&b.width==null)b.width=a.style.width;if(a.style.height&&b.height==null)b.height=a.style.height;if(b.content==null)b.content=a.value;if(a.form&&(typeof a.form.addEventListener=="function"?a.form.addEventListener("submit",d,!1):a.form.attachEvent("onsubmit",d),typeof a.form.submit=="function")){var k=a.form.submit,
p=function(){d();a.form.submit=k;a.form.submit();a.form.submit=p};a.form.submit=p}a.style.display="none";var h=new l(function(b){a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)},b);h.save=d;h.toTextArea=function(){d();a.parentNode.removeChild(h.wrapping);a.style.display="";if(a.form){if(typeof a.form.submit=="function")a.form.submit=k;typeof a.form.removeEventListener=="function"?a.form.removeEventListener("submit",d,!1):a.form.detachEvent("onsubmit",d)}};return h};
l.isProbablySupported=function(){var a;return window.opera?Number(window.opera.version())>=9.52:/Apple Computer, Inc/.test(navigator.vendor)&&(a=navigator.userAgent.match(/Version\/(\d+(?:\.\d+)?)\./))?Number(a[1])>=3:document.selection&&window.ActiveXObject&&(a=navigator.userAgent.match(/MSIE (\d+(?:\.\d*)?)\b/))?Number(a[1])>=6:(a=navigator.userAgent.match(/gecko\/(\d{8})/i))?Number(a[1])>=20050901:(a=navigator.userAgent.match(/AppleWebKit\/(\d+)/))?Number(a[1])>=525:null};return l}();
function method(c,g){return function(){c[g].apply(c,arguments)}}var StopIteration={toString:function(){return"StopIteration"}};function forEach(c,g){if(c.next)try{for(;;)g(c.next())}catch(e){if(e!=StopIteration)throw e;}else for(var f=0;f<c.length;f++)g(c[f])}function map(c,g){var e=[];forEach(c,function(c){e.push(g(c))});return e}function matcher(c){return function(g){return c.test(g)}}function hasClass(c,g){var e=c.className;return e&&RegExp("(^| )"+g+"($| )").test(e)}
function removeClass(c,g){c.className=c.className.replace(RegExp(" "+g+"\\b","g"),"");return c}function insertAfter(c,g){g.parentNode.insertBefore(c,g.nextSibling);return c}function removeElement(c){c.parentNode&&c.parentNode.removeChild(c)}function clearElement(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function isAncestor(c,g){for(;g=g.parentNode;)if(c==g)return!0;return!1}var nbsp="\u00a0",matching={"{":"}","[":"]","(":")","}":"{","]":"[",")":"("};
function normalizeEvent(c){if(!c.stopPropagation)c.stopPropagation=function(){this.cancelBubble=!0},c.preventDefault=function(){this.returnValue=!1};if(!c.stop)c.stop=function(){this.stopPropagation();this.preventDefault()};if(c.type=="keypress")c.code=c.charCode==null?c.keyCode:c.charCode,c.character=String.fromCharCode(c.code);return c}
function addEventHandler(c,g,e,f){function j(c){e(normalizeEvent(c||window.event))}if(typeof c.addEventListener=="function"){if(c.addEventListener(g,j,!1),f)return function(){c.removeEventListener(g,j,!1)}}else if(c.attachEvent("on"+g,j),f)return function(){c.detachEvent("on"+g,j)}}function nodeText(c){return c.textContent||c.innerText||c.nodeValue||""}function nodeTop(c){for(var g=0;c.offsetParent;)g+=c.offsetTop,c=c.offsetParent;return g}function isBR(c){c=c.nodeName;return c=="BR"||c=="br"}
function isSpan(c){c=c.nodeName;return c=="SPAN"||c=="span"}
var stringStream=function(c){function g(){for(;f==e.length;){j+=e;e="";f=0;try{e=c.next()}catch(l){if(l!=StopIteration)throw l;else return!1}}return!0}var e="",f=0,j="";return{peek:function(){if(!g())return null;return e.charAt(f)},next:function(){if(!g())if(j.length>0)throw"End of stringstream reached without emptying buffer ('"+j+"').";else throw StopIteration;return e.charAt(f++)},get:function(){var c=j;j="";f>0&&(c+=e.slice(0,f),e=e.slice(f),f=0);return c},push:function(c){e=e.slice(0,f)+c+e.slice(f)},
lookAhead:function(l,n,a,b){function d(a){return b?a.toLowerCase():a}var l=d(l),k=!1,p=j,h=f;for(a&&this.nextWhileMatches(/[\s\u00a0]/);;){var a=f+l.length,i=e.length-f;if(a<=e.length){k=l==d(e.slice(f,a));f=a;break}else if(l.slice(0,i)==d(e.slice(f))){j+=e;e="";try{e=c.next()}catch(m){if(m!=StopIteration)throw m;break}f=0;l=l.slice(i)}else break}if(!k||!n)e=j.slice(p.length)+e,f=h,j=p;return k},lookAheadRegex:function(l,n){if(l.source.charAt(0)!="^")throw Error("Regexps passed to lookAheadRegex must start with ^");
for(;e.indexOf("\n",f)==-1;)try{e+=c.next()}catch(a){if(a!=StopIteration)throw a;break}var b=e.slice(f).match(l);b&&n&&(f+=b[0].length);return b},more:function(){return this.peek()!==null},applies:function(c){var e=this.peek();return e!==null&&c(e)},nextWhile:function(c){for(var e;(e=this.peek())!==null&&c(e);)this.next()},matches:function(c){var e=this.peek();return e!==null&&c.test(e)},nextWhileMatches:function(c){for(var e;(e=this.peek())!==null&&c.test(e);)this.next()},equals:function(c){return c===
this.peek()},endOfLine:function(){var c=this.peek();return c==null||c=="\n"}}},select={};
(function(){function c(a,b){for(;a&&a.parentNode!=b;)a=a.parentNode;return a}function g(a,b){for(;!a.previousSibling&&a.parentNode!=b;)a=a.parentNode;return c(a.previousSibling,b)}function e(a){var b=a.nextSibling;if(b){for(;b.firstChild;)b=b.firstChild;return b.nodeType==3||isBR(b)?b:e(b)}else{for(a=a.parentNode;a&&!a.nextSibling;)a=a.parentNode;return a&&e(a)}}select.ie_selection=document.selection&&document.selection.createRangeCollection;if(parseInt(navigator.appVersion)>=5)select.ie_selection=
!1;select.scrollToNode=function(a,b){if(a){for(var d=a,c=document.body,m=document.documentElement,e=!d.nextSibling||!d.nextSibling.nextSibling||!d.nextSibling.nextSibling.nextSibling,q=0;d&&!d.offsetTop;)q++,d=d.previousSibling;q==0&&(e=!1);if(!webkit||!d||!(d.offsetTop==5&&d.offsetLeft==5)){q*=d?d.offsetHeight:0;for(var f=0,g=a?a.offsetWidth:0;d&&d.offsetParent;)q+=d.offsetTop,isBR(d)||(f+=d.offsetLeft),d=d.offsetParent;var d=c.scrollLeft||m.scrollLeft||0,c=c.scrollTop||m.scrollTop||0,j=!1,n=window.innerWidth||
m.clientWidth||0;if(b||g<n){if(b){var l=select.offsetInNode(a),t=nodeText(a).length;t&&(f+=g*(l/t))}g=f-d;if(g<0||g>n)d=f,j=!0}f=q-c;if(f<0||e||f>(window.innerHeight||m.clientHeight||0)-50)c=e?1E6:q,j=!0;j&&window.scrollTo(d,c)}}};select.scrollToCursor=function(a){select.scrollToNode(select.selectionTopNode(a,!0)||a.firstChild,!0)};var f=null;select.snapshotChanged=function(){if(f)f.changed=!0};select.snapshotReplaceNode=function(a,b,d,c){function m(m){if(a==m.node)f.changed=!0,d&&m.offset>d?m.offset-=
d:(m.node=b,m.offset+=c||0);else if(select.ie_selection&&m.offset==0&&m.node==e(a))f.changed=!0}f&&(m(f.start),m(f.end))};select.snapshotMove=function(a,b,d,c,m){function e(s){if(a==s.node&&(!m||s.offset==0))f.changed=!0,s.node=b,s.offset=c?Math.max(0,s.offset+d):d}f&&(e(f.start),e(f.end))};if(select.ie_selection){var j=function(){var a=document.selection;if(!a)return null;return a.createRange?a.createRange():a.createTextRange()},l=function(a){function b(a){for(var k=null;!k&&a;)k=a.nextSibling,a=
a.parentNode;return d(k)}function d(a){for(;a&&a.firstChild;)a=a.firstChild;return{node:a,offset:0}}var c=j();c.collapse(a);a=c.parentElement();if(!isAncestor(document.body,a))return null;if(!a.firstChild)return d(a);var m=c.duplicate();m.moveToElementText(a);m.collapse(!0);for(var e=a.firstChild;e;e=e.nextSibling){if(e.nodeType==3){var f=e.nodeValue.length;m.move("character",f)}else m.moveToElementText(e),m.collapse(!1);var g=c.compareEndPoints("StartToStart",m);if(g==0)return b(e);if(g!=1){if(e.nodeType!=
3)return d(e);m.setEndPoint("StartToEnd",c);return{node:e,offset:f-m.text.length}}}return b(a)};select.markSelection=function(){f=null;if(document.selection){var a=l(!0),b=l(!1);a&&b&&(f={start:a,end:b,changed:!1})}};select.selectMarked=function(){function a(b){var d=document.body.createTextRange(),k=b.node;if(k)if(k.nodeType==3){d.moveToElementText(k.parentNode);for(b=b.offset;k.previousSibling;)k=k.previousSibling,b+=(k.innerText||"").length;d.move("character",b)}else d.moveToElementText(k),d.collapse(!0);
else d.moveToElementText(document.body),d.collapse(!1);return d}if(f&&f.changed){var b=a(f.start),d=a(f.end);b.setEndPoint("StartToEnd",d);b.select()}};select.offsetInNode=function(a){var b=j();if(!b)return 0;var d=b.duplicate();try{d.moveToElementText(a)}catch(c){return 0}b.setEndPoint("StartToStart",d);return b.text.length};select.selectionTopNode=function(a,b){function d(a,b){if(b.nodeType==3){for(var k=0,c=b.previousSibling;c&&c.nodeType==3;)k+=c.nodeValue.length,c=c.previousSibling;if(c){try{a.moveToElementText(c)}catch(h){return!1}a.collapse(!1)}else a.moveToElementText(b.parentNode);
k&&a.move("character",k)}else try{a.moveToElementText(b)}catch(p){return!1}return!0}var i=j();if(!i)return!1;var e=i.duplicate();i.collapse(b);var f=i.parentElement();if(f&&isAncestor(a,f)&&(e.moveToElementText(f),i.compareEndPoints("StartToStart",e)==1))return c(f,a);b=0;for(f=a.childNodes.length-1;b<f;){var g=Math.ceil((f+b)/2),n=a.childNodes[g];if(!n)return!1;if(!d(e,n))return!1;i.compareEndPoints("StartToStart",e)==1?b=g:f=g-1}if(b==0){i=j();e=i.duplicate();try{e.moveToElementText(a)}catch(l){return null}if(i.compareEndPoints("StartToStart",
e)==0)return null}return a.childNodes[b]||null};select.focusAfterNode=function(a,b){var d=document.body.createTextRange();d.moveToElementText(a||b);d.collapse(!a);d.select()};select.somethingSelected=function(){var a=j();return a&&a.text!=""};var n=function(a){var b=j();b&&(b.pasteHTML(a),b.collapse(!1),b.select())};select.insertNewlineAtCursor=function(){n("<br>")};select.insertTabAtCursor=function(){n("\u00a0\u00a0\u00a0\u00a0")};select.cursorPos=function(a,b){var d=j();if(!d)return null;for(var c=
select.selectionTopNode(a,b);c&&!isBR(c);)c=c.previousSibling;var e=d.duplicate();d.collapse(b);if(c)e.moveToElementText(c),e.collapse(!1);else{try{e.moveToElementText(a)}catch(f){return null}e.collapse(!0)}d.setEndPoint("StartToStart",e);return{node:c,offset:d.text.length}};select.setCursorPos=function(a,b,d){function c(b){var d=document.body.createTextRange();b.node?(d.moveToElementText(b.node),d.collapse(!1)):(d.moveToElementText(a),d.collapse(!0));d.move("character",b.offset);return d}var e=c(b);
d&&d!=b&&e.setEndPoint("EndToEnd",c(d));e.select()};select.getBookmark=function(a){var b=select.cursorPos(a,!0),a=select.cursorPos(a,!1);if(b&&a)return{from:b,to:a}};select.setBookmark=function(a,b){b&&select.setCursorPos(a,b.from,b.to)}}else{var a=function(a,b){for(;a.nodeType!=3&&!isBR(a);){for(var d=a.childNodes[b]||a.nextSibling,b=0;!d&&a.parentNode;)a=a.parentNode,d=a.nextSibling;a=d;if(!d)break}return{node:a,offset:b}};select.markSelection=function(){var b=window.getSelection();if(!b||b.rangeCount==
0)return f=null;b=b.getRangeAt(0);f={start:a(b.startContainer,b.startOffset),end:a(b.endContainer,b.endOffset),changed:!1}};select.selectMarked=function(){function d(){if(h.start.node==h.end.node&&h.start.offset==h.end.offset){var b=window.getSelection();if(!b||b.rangeCount==0)return!0;b=b.getRangeAt(0);b=a(b.startContainer,b.startOffset);return h.start.node!=b.node||h.start.offset!=b.offset}}function c(a,b){if(a.node)if(a.offset==0)i["set"+b+"Before"](a.node);else i["set"+b](a.node,a.offset);else i.setStartAfter(document.body.lastChild||
document.body)}var h=f;if(h&&(h.changed||webkit&&d())){var i=document.createRange();c(h.end,"End");c(h.start,"Start");b(i)}};var b=function(a){var b=window.getSelection();b&&(b.removeAllRanges(),b.addRange(a))},d=function(){var a=window.getSelection();return!a||a.rangeCount==0?!1:a.getRangeAt(0)};select.selectionTopNode=function(a,b){var h=d();if(!h)return!1;var i=b?h.startContainer:h.endContainer,e=b?h.startOffset:h.endOffset;window.opera&&!b&&h.endContainer==a&&h.endOffset==h.startOffset+1&&a.childNodes[h.startOffset]&&
isBR(a.childNodes[h.startOffset])&&e--;return i.nodeType==3?e>0?c(i,a):g(i,a):i.nodeName.toUpperCase()=="HTML"?e==1?null:a.lastChild:i==a?e==0?null:i.childNodes[e-1]:e==i.childNodes.length?c(i,a):e==0?g(i,a):c(i.childNodes[e-1],a)};select.focusAfterNode=function(a,d){var c=document.createRange();c.setStartBefore(d.firstChild||d);a&&!a.firstChild?c.setEndAfter(a):a?c.setEnd(a,a.childNodes.length):c.setEndBefore(d.firstChild||d);c.collapse(!1);b(c)};select.somethingSelected=function(){var a=d();return a&&
!a.collapsed};select.offsetInNode=function(a){var b=d();if(!b)return 0;b=b.cloneRange();b.setStartBefore(a);return b.toString().length};select.insertNodeAtCursor=function(a){var c=d();if(c){c.deleteContents();c.insertNode(a);webkitLastLineHack(document.body);if(window.opera&&isBR(a)&&isSpan(a.parentNode)){var c=a.nextSibling,h=a.parentNode,e=h.parentNode;e.insertBefore(a,h.nextSibling);for(h="";c&&c.nodeType==3;c=c.nextSibling)h+=c.nodeValue,removeElement(c);e.insertBefore(makePartSpan(h,document),
a.nextSibling)}c=document.createRange();c.selectNode(a);c.collapse(!1);b(c)}};select.insertNewlineAtCursor=function(){select.insertNodeAtCursor(document.createElement("BR"))};select.insertTabAtCursor=function(){select.insertNodeAtCursor(document.createTextNode("\u00a0\u00a0\u00a0\u00a0"))};select.cursorPos=function(a,b){var c=d();if(c){for(var e=select.selectionTopNode(a,b);e&&!isBR(e);)e=e.previousSibling;c=c.cloneRange();c.collapse(b);e?c.setStartAfter(e):c.setStartBefore(a);return{node:e,offset:c.toString().length}}};
select.setCursorPos=function(a,d,c){function e(b,d,c){function h(a){a.nodeType==3?i.push(a):forEach(a.childNodes,h)}if(d==0&&b&&!b.nextSibling)return f["set"+c+"After"](b),!0;if(b=b?b.nextSibling:a.firstChild){if(d==0)return f["set"+c+"Before"](b),!0;for(var i=[];;){for(;b&&!i.length;)h(b),b=b.nextSibling;var p=i.shift();if(!p)return!1;var g=p.nodeValue.length;if(g>=d)return f["set"+c](p,d),!0;d-=g}}}var f=document.createRange(),c=c||d;e(c.node,c.offset,"End")&&e(d.node,d.offset,"Start")&&b(f)}}})();
function UndoHistory(c,g,e,f){this.container=c;this.maxDepth=g;this.commitDelay=e;this.editor=f;this.last=this.first=c={text:"",from:null,to:null};this.firstTouched=!1;this.history=[];this.redoHistory=[];this.touched=[];this.lostundo=0}
UndoHistory.prototype={scheduleCommit:function(){var c=this;parent.clearTimeout(this.commitTimeout);this.commitTimeout=parent.setTimeout(function(){c.tryCommit()},this.commitDelay)},touch:function(c){this.setTouched(c);this.scheduleCommit()},undo:function(){this.commit();if(this.history.length){var c=this.history.pop();this.redoHistory.push(this.updateTo(c,"applyChain"));this.notifyEnvironment();return this.chainNode(c)}},redo:function(){this.commit();if(this.redoHistory.length){var c=this.redoHistory.pop();
this.addUndoLevel(this.updateTo(c,"applyChain"));this.notifyEnvironment();return this.chainNode(c)}},clear:function(){this.history=[];this.redoHistory=[];this.lostundo=0},historySize:function(){return{undo:this.history.length,redo:this.redoHistory.length,lostundo:this.lostundo}},push:function(c,g,e){for(var f=[],j=0;j<e.length;j++){var l=j==e.length-1?g:document.createElement("br");f.push({from:c,to:l,text:cleanText(e[j])});c=l}this.pushChains([f],c==null&&g==null);this.notifyEnvironment()},pushChains:function(c,
g){this.commit(g);this.addUndoLevel(this.updateTo(c,"applyChain"));this.redoHistory=[]},chainNode:function(c){for(var g=0;g<c.length;g++){var e=c[g][0];if(e=e&&(e.from||e.to))return e}},reset:function(){this.history=[];this.redoHistory=[];this.lostundo=0},textAfter:function(c){return this.after(c).text},nodeAfter:function(c){return this.after(c).to},nodeBefore:function(c){return this.before(c).from},tryCommit:function(){window&&window.parent&&window.UndoHistory&&(this.editor.highlightDirty()?this.commit(!0):
this.scheduleCommit())},commit:function(c){parent.clearTimeout(this.commitTimeout);c||this.editor.highlightDirty(!0);c=this.touchedChains();if(c.length)this.addUndoLevel(this.updateTo(c,"linkChain")),this.redoHistory=[],this.notifyEnvironment()},updateTo:function(c,g){for(var e=[],f=[],j=0;j<c.length;j++)e.push(this.shadowChain(c[j])),f.push(this[g](c[j]));g=="applyChain"&&this.notifyDirty(f);return e},notifyDirty:function(c){forEach(c,method(this.editor,"addDirtyNode"));this.editor.scheduleHighlight()},
notifyEnvironment:function(){if(this.onChange)this.onChange(this.editor);window.frameElement&&window.frameElement.CodeMirror.updateNumbers&&window.frameElement.CodeMirror.updateNumbers()},linkChain:function(c){for(var g=0;g<c.length;g++){var e=c[g];e.from?e.from.historyAfter=e:this.first=e;e.to?e.to.historyBefore=e:this.last=e}},after:function(c){return c?c.historyAfter:this.first},before:function(c){return c?c.historyBefore:this.last},setTouched:function(c){if(c){if(!c.historyTouched)this.touched.push(c),
c.historyTouched=!0}else this.firstTouched=!0},addUndoLevel:function(c){this.history.push(c);this.history.length>this.maxDepth&&(this.history.shift(),this.lostundo+=1)},touchedChains:function(){function c(c){for(var a=[],b=c?c.nextSibling:e.container.firstChild;b&&(!isBR(b)||b.hackBR);b=b.nextSibling)!b.hackBR&&b.currentText&&a.push(b.currentText);return{from:c,to:b,text:cleanText(a.join(""))}}function g(c,a){for(var b=a+"Sibling",d=c[b];d&&!isBR(d);)d=d[b];return d}var e=this,f=null,j=[];e.firstTouched&&
e.touched.push(null);forEach(e.touched,function(g){if(!g||!(g.parentNode!=e.container||g.hackBR)){g?g.historyTouched=!1:e.firstTouched=!1;var a=c(g),b=e.after(g);if(!b||b.text!=a.text||b.to!=a.to)j.push(a),g?g.historyTemp=a:f=a}});var l=[];e.touched=[];forEach(j,function(j){if(j.from?j.from.historyTemp:f){for(var a=[],b=j.from,d=!0;;){var k=b?b.historyTemp:f;if(!k)if(d)break;else k=c(b);a.unshift(k);b?b.historyTemp=null:f=null;if(!b)break;d=e.after(b);b=g(b,"previous")}b=j.to;for(d=e.before(j.from);;){if(!b)break;
k=b?b.historyTemp:f;if(!k)if(d)break;else k=c(b);a.push(k);b?b.historyTemp=null:f=null;d=e.before(b);b=g(b,"next")}l.push(a)}});return l},shadowChain:function(c){for(var g=[],e=this.after(c[0].from),c=c[c.length-1].to;;)if(g.push(e),e=e.to,!e||e==c)break;else e=e.historyAfter||this.before(c);return g},applyChain:function(c){var g=select.cursorPos(this.container,!1),e=this,f=c[0].from,j=c[c.length-1].to;(function(a,b){for(var d=a?a.nextSibling:e.container.firstChild;d!=b;){var c=d.nextSibling;removeElement(d);
d=c}})(f,j);for(var l=0;l<c.length;l++){var n=c[l];l>0&&e.container.insertBefore(n.from,j);var a=makePartSpan(fixSpaces(n.text));e.container.insertBefore(a,j);if(g&&g.node==n.from){var a=0,b=this.after(n.from);if(b&&l==c.length-1){for(var d=0;d<g.offset&&n.text.charAt(d)==b.text.charAt(d);d++);g.offset>d&&(a=n.text.length-b.text.length)}select.setCursorPos(this.container,{node:n.from,offset:Math.max(0,g.offset+a)})}else g&&l==c.length-1&&g.node&&g.node.parentNode!=this.container&&select.setCursorPos(this.container,
{node:n.from,offset:n.text.length})}this.linkChain(c);return f}};var internetExplorer=document.selection&&window.ActiveXObject&&/MSIE/.test(navigator.userAgent),webkit=/AppleWebKit/.test(navigator.userAgent),safari=/Apple Computer, Inc/.test(navigator.vendor),gecko=navigator.userAgent.match(/gecko\/(\d{8})/i);gecko&&(gecko=Number(gecko[1]));var mac=/Mac/.test(navigator.platform),brokenOpera=window.opera&&/Version\/10.[56]/.test(navigator.userAgent),slowWebkit=/AppleWebKit\/533/.test(navigator.userAgent);
function makeWhiteSpace(c){for(var g=[],e=!0;c>0;c--)g.push(e||c==1?nbsp:" "),e^=1;return g.join("")}function fixSpaces(c){c.charAt(0)==" "&&(c=nbsp+c.slice(1));return c.replace(/\t/g,function(){return makeWhiteSpace(indentUnit)}).replace(/[ \u00a0]{2,}/g,function(c){return makeWhiteSpace(c.length)})}function cleanText(c){return c.replace(/\u00a0/g," ").replace(/\u200b/g,"")}
function makePartSpan(c){var g=c;c.nodeType==3?g=c.nodeValue:c=document.createTextNode(g);var e=document.createElement("span");e.isPart=!0;e.appendChild(c);e.currentText=g;return e}function alwaysZero(){return 0}var webkitLastLineHack=webkit?function(c){var g=c.lastChild;if(!g||!g.hackBR)g=document.createElement("br"),g.hackBR=!0,c.appendChild(g)}:function(){};
function asEditorLines(c){var g=makeWhiteSpace(indentUnit);return map(c.replace(/\t/g,g).replace(/\u00a0/g," ").replace(/\r\n?/g,"\n").split("\n"),fixSpaces)}
var Editor=function(){function c(a,b){function d(a,i){if(a.nodeType==3)(a.nodeValue=fixSpaces(a.nodeValue.replace(/[\r\u200b]/g,"").replace(/\n/g," "))).length&&(e=!1),c.push(a);else if(isBR(a)&&a.childNodes.length==0)e=!0,c.push(a);else{for(var f=a.firstChild;f;f=f.nextSibling)d(f);!e&&n.hasOwnProperty(a.nodeName.toUpperCase())&&(e=!0,(!b||!i)&&c.push(document.createElement("br")))}}var c=[],e=!0;d(a,!0);return c}function g(a){function b(a){var b=a.parentNode,d=a.nextSibling;return function(a){b.insertBefore(a,
d)}}var d=[],k=null,e=!0;return{next:function(){if(!a)throw StopIteration;var h=a;a=h.nextSibling;var i;h.isPart&&h.childNodes.length==1&&h.firstChild.nodeType==3?(i=h.firstChild.nodeValue,h.dirty=h.dirty||i!=h.currentText,h.currentText=i,i=!/[\n\t\r]/.test(h.currentText)):i=!1;if(i)return d.push(h),e=!1,h.currentText;else if(isBR(h))return e&&window.opera&&h.parentNode.insertBefore(makePartSpan(""),h),d.push(h),e=!0,"\n";else{i=!h.nextSibling;k=b(h);removeElement(h);h=c(h,i);for(i=0;i<h.length;i++){var f=
h,g=i,j=h[i],l="\n";j.nodeType==3?(select.snapshotChanged(),j=makePartSpan(j),l=j.currentText,e=!1):(e&&window.opera&&k(makePartSpan("")),e=!0);j.dirty=!0;d.push(j);k(j);f[g]=l}return h.join("")}},nodes:d}}function e(a){for(;a&&!isBR(a);)a=a.previousSibling;return a}function f(a,b){if(a){if(isBR(a))a=a.nextSibling}else a=b.firstChild;for(;a&&!isBR(a);)a=a.nextSibling;return a}function j(a,b,d,c){function e(b){b=cleanText(a.history.textAfter(b));return c?b.toLowerCase():b}this.editor=a;this.history=
a.history;this.history.commit();this.valid=!!b;this.atOccurrence=!1;c==void 0&&(c=typeof b=="string"&&b==b.toLowerCase());var h={node:null,offset:0},i=this;d&&typeof d=="object"&&typeof d.character=="number"?(a.checkLine(d.line),d={node:d.line,offset:d.character},this.pos={from:d,to:d}):this.pos=d?{from:select.cursorPos(a.container,!0)||h,to:select.cursorPos(a.container,!1)||h}:{from:h,to:h};if(typeof b!="string")this.matches=function(a,d,c){if(a)for(var a=e(d).slice(0,c),k=a.match(b),c=0;k;){var h=
a.indexOf(k[0]);c+=h;a=a.slice(h+1);if(h=a.match(b))k=h;else break}else a=e(d).slice(c),c=(k=a.match(b))&&c+a.indexOf(k[0]);if(k)return i.currentMatch=k,{from:{node:d,offset:c},to:{node:d,offset:c+k[0].length}}};else{c&&(b=b.toLowerCase());var f=b.split("\n");this.matches=f.length==1?function(a,d,c){var k=e(d),h=b.length,i;if(a?c>=h&&(i=k.lastIndexOf(b,c-h))!=-1:(i=k.indexOf(b,c))!=-1)return{from:{node:d,offset:i},to:{node:d,offset:i+h}}}:function(a,b,d){var c=a?f.length-1:0,k=f[c],h=e(b),i=a?h.indexOf(k)+
k.length:h.lastIndexOf(k);if(!(a?i>=d||i!=k.length:i<=d||i!=h.length-k.length))for(d=b;;){if(a&&!d)break;d=a?this.history.nodeBefore(d):this.history.nodeAfter(d);if(!a&&!d)break;h=e(d);k=f[a?--c:++c];if(c>0&&c<f.length-1)if(h!=k)break;else continue;c=a?h.lastIndexOf(k):h.indexOf(k)+k.length;if(a?c!=h.length-k.length:c!=k.length)break;return{from:{node:a?d:b,offset:a?c:i},to:{node:a?b:d,offset:a?i:c}}}}}}function l(a){this.options=a;window.indentUnit=a.indentUnit;var b=this.container=document.body;
this.history=new UndoHistory(b,a.undoDepth,a.undoDelay,this);var d=this;if(!l.Parser)throw"No parser loaded.";a.parserConfig&&l.Parser.configure&&l.Parser.configure(a.parserConfig);!a.readOnly&&!internetExplorer&&select.setCursorPos(b,{node:null,offset:0});this.dirty=[];this.importCode(a.content||"");this.history.onChange=a.onChange;if(a.readOnly){if(!a.textWrapping)b.style.whiteSpace="nowrap"}else{if(a.continuousScanning!==!1)this.scanner=this.documentScanner(a.passTime),this.delayScanning();var c=
function(){document.body.contentEditable!=void 0&&internetExplorer?document.body.contentEditable="true":document.designMode="on";if(internetExplorer&&a.height!="dynamic")document.body.style.minHeight=window.frameElement.clientHeight-2*document.body.offsetTop-5+"px";document.documentElement.style.borderWidth="0";if(!a.textWrapping)b.style.whiteSpace="nowrap"};try{c()}catch(e){var h=addEventHandler(document,"focus",function(){h();c()},!0)}addEventHandler(document,"keydown",method(this,"keyDown"));addEventHandler(document,
"keypress",method(this,"keyPress"));addEventHandler(document,"keyup",method(this,"keyUp"));var i=function(){d.cursorActivity(!1)};addEventHandler(internetExplorer?document.body:window,"mouseup",i);addEventHandler(document.body,"cut",i);gecko&&addEventHandler(window,"pagehide",function(){d.unloaded=!0});addEventHandler(document.body,"paste",function(a){i();var b=null;try{var c=a.clipboardData||window.clipboardData;c&&(b=c.getData("Text"))}catch(k){}b!==null&&(a.stop(),d.replaceSelection(b),select.scrollToCursor(d.container))});
this.options.autoMatchParens&&addEventHandler(document.body,"click",method(this,"scheduleParenHighlight"))}}var n={P:!0,DIV:!0,LI:!0};j.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){function b(){var a={node:e,offset:h};d.pos={from:a,to:a};return d.atOccurrence=!1}if(!this.valid)return!1;var d=this,c=a?this.pos.from:this.pos.to,e=c.node,h=c.offset;e&&!e.parentNode&&(e=null,h=0);for(;;){if(this.pos=this.matches(a,e,h))return this.atOccurrence=
!0;if(a){if(!e)return b();e=this.history.nodeBefore(e);h=this.history.textAfter(e).length}else{c=this.history.nodeAfter(e);if(!c)return h=this.history.textAfter(e).length,b();e=c;h=0}}},select:function(){this.atOccurrence&&(select.setCursorPos(this.editor.container,this.pos.from,this.pos.to),select.scrollToCursor(this.editor.container))},replace:function(a){if(this.atOccurrence){var b=this.currentMatch;b&&(a=a.replace(/\\(\d)/,function(a,c){return b[c]}));this.pos.to=this.editor.replaceRange(this.pos.from,
this.pos.to,a);this.atOccurrence=!1}},position:function(){if(this.atOccurrence)return{line:this.pos.from.node,character:this.pos.from.offset}}};l.prototype={importCode:function(a){var b=asEditorLines(a);if(!this.options.incrementalLoading||b.length<1E3)this.history.push(null,null,b),this.history.reset();else{var d=0,c=this,e=function(){var a=b.slice(d,d+1E3);a.push("");c.history.push(c.history.nodeBefore(null),null,a);c.history.reset();d+=1E3;d<b.length&&parent.setTimeout(e,1E3)};e()}},getCode:function(){if(!this.container.firstChild)return"";
var a=[];select.markSelection();forEach(g(this.container.firstChild),method(a,"push"));select.selectMarked();webkit&&this.container.lastChild.hackBR&&a.pop();webkitLastLineHack(this.container);return cleanText(a.join(""))},checkLine:function(a){if(a===!1||!(a==null||a.parentNode==this.container||a.hackBR))throw parent.CodeMirror.InvalidLineHandle;},cursorPosition:function(a){a==null&&(a=!0);return(a=select.cursorPos(this.container,a))?{line:a.node,character:a.offset}:{line:null,character:0}},firstLine:function(){return null},
lastLine:function(){var a=this.container.lastChild;a&&(a=e(a));a&&a.hackBR&&(a=e(a.previousSibling));return a},nextLine:function(a){this.checkLine(a);a=f(a,this.container);return!a||a.hackBR?!1:a},prevLine:function(a){this.checkLine(a);if(a==null)return!1;return e(a.previousSibling)},visibleLineCount:function(){for(var a=this.container.firstChild;a&&isBR(a);)a=a.nextSibling;if(!a)return!1;return Math.floor((window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)/a.offsetHeight)},
selectLines:function(a,b,d,c){this.checkLine(a);a={node:a,offset:b};b=null;c!==void 0&&(this.checkLine(d),b={node:d,offset:c});select.setCursorPos(this.container,a,b);select.scrollToCursor(this.container)},lineContent:function(a){for(var b=[],a=a?a.nextSibling:this.container.firstChild;a&&!isBR(a);a=a.nextSibling)b.push(nodeText(a));return cleanText(b.join(""))},setLineContent:function(a,b){this.history.commit();this.replaceRange({node:a,offset:0},{node:a,offset:this.history.textAfter(a).length},
b);this.addDirtyNode(a);this.scheduleHighlight()},removeLine:function(a){for(var b=a?a.nextSibling:this.container.firstChild;b;){var d=b.nextSibling;removeElement(b);if(isBR(b))break;b=d}this.addDirtyNode(a);this.scheduleHighlight()},insertIntoLine:function(a,b,d){var c=null;if(b=="end")c=f(a,this.container);else for(var e=a?a.nextSibling:this.container.firstChild;e;e=e.nextSibling){if(b==0){c=e;break}var h=nodeText(e);if(h.length>b){c=e.nextSibling;d=h.slice(0,b)+d+h.slice(b);removeElement(e);break}b-=
h.length}b=asEditorLines(d);for(d=0;d<b.length;d++)d>0&&this.container.insertBefore(document.createElement("BR"),c),this.container.insertBefore(makePartSpan(b[d]),c);this.addDirtyNode(a);this.scheduleHighlight()},selectedText:function(){var a=this.history;a.commit();var b=select.cursorPos(this.container,!0),d=select.cursorPos(this.container,!1);if(!b||!d)return"";if(b.node==d.node)return a.textAfter(b.node).slice(b.offset,d.offset);for(var c=[a.textAfter(b.node).slice(b.offset)],b=a.nodeAfter(b.node);b!=
d.node;b=a.nodeAfter(b))c.push(a.textAfter(b));c.push(a.textAfter(d.node).slice(0,d.offset));return cleanText(c.join("\n"))},replaceSelection:function(a){this.history.commit();var b=select.cursorPos(this.container,!0),d=select.cursorPos(this.container,!1);b&&d&&(d=this.replaceRange(b,d,a),select.setCursorPos(this.container,d),webkitLastLineHack(this.container))},cursorCoords:function(a,b){function d(a,d){var c=-(document.body.scrollTop||document.documentElement.scrollTop||0),e=-(document.body.scrollLeft||
document.documentElement.scrollLeft||0)+d;forEach([a,b?null:window.frameElement],function(a){for(;a;)e+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent});return{x:e,y:c,yBot:c+a.offsetHeight}}function c(a,b){var d=document.createElement("SPAN");d.appendChild(document.createTextNode(a));try{return b(d)}finally{d.parentNode&&d.parentNode.removeChild(d)}}var e=select.cursorPos(this.container,a);if(!e)return null;for(var h=e.offset,i=e.node,f=this;h;){i=i?i.nextSibling:this.container.firstChild;e=nodeText(i);
if(h<e.length)return c(e.substr(0,h),function(a){a.style.position="absolute";a.style.visibility="hidden";a.className=i.className;f.container.appendChild(a);return d(i,a.offsetWidth)});h-=e.length}return i&&isSpan(i)?d(i,i.offsetWidth):i&&i.nextSibling&&isSpan(i.nextSibling)?d(i.nextSibling,0):c("\u200b",function(a){i?i.parentNode.insertBefore(a,i.nextSibling):f.container.insertBefore(a,f.container.firstChild);return d(a,0)})},reroutePasteEvent:function(){if(!this.capturingPaste&&!(window.opera||gecko&&
gecko>=20101026)){this.capturingPaste=!0;var a=window.frameElement.CodeMirror.textareaHack,b=this.cursorCoords(!0,!0);a.style.top=b.y+"px";var b=internetExplorer&&!select.getBookmark,d;if(internetExplorer)if(b)d=document.selection.createRange();else if(b=select.getBookmark(this.container))this.selectionSnapshot=b;parent.focus();a.value="";a.focus();var c=this;parent.setTimeout(function(){c.capturingPaste=!1;window.focus();d&&d.select();c.selectionSnapshot&&window.select.setBookmark(c.container,c.selectionSnapshot);
var b=a.value;b&&(c.replaceSelection(b),select.scrollToCursor(c.container))},10)}},replaceRange:function(a,b,d){d=asEditorLines(d);d[0]=this.history.textAfter(a.node).slice(0,a.offset)+d[0];var c=d[d.length-1];d[d.length-1]=c+this.history.textAfter(b.node).slice(b.offset);b=this.history.nodeAfter(b.node);this.history.push(a.node,b,d);return{node:this.history.nodeBefore(b),offset:c.length}},getSearchCursor:function(a,b,d){return new j(this,a,b,d)},reindent:function(){this.container.firstChild&&this.indentRegion(null,
this.container.lastChild)},reindentSelection:function(a){if(select.somethingSelected()){var b=select.selectionTopNode(this.container,!0),d=select.selectionTopNode(this.container,!1);b===!1||d===!1||this.indentRegion(b,d,a,!0)}else this.indentAtCursor(a)},grabKeys:function(a,b){this.frozen=a;this.keyFilter=b},ungrabKeys:function(){this.frozen="leave"},setParser:function(a,b){l.Parser=window[a];(b=b||this.options.parserConfig)&&l.Parser.configure&&l.Parser.configure(b);this.container.firstChild&&(forEach(this.container.childNodes,
function(a){if(a.nodeType!=3)a.dirty=!0}),this.addDirtyNode(this.firstChild),this.scheduleHighlight())},keyDown:function(a){if(this.frozen=="leave")this.keyFilter=this.frozen=null;if(this.frozen&&(!this.keyFilter||this.keyFilter(a.keyCode,a)))a.stop(),this.frozen(a);else{var b=a.keyCode;this.delayScanning();this.options.autoMatchParens&&this.scheduleParenHighlight();if(b==13)a.ctrlKey&&!a.altKey?this.reparseBuffer():(select.insertNewlineAtCursor(),b=this.options.enterMode,b!="flat"&&this.indentAtCursor(b==
"keep"?"keep":void 0),select.scrollToCursor(this.container)),a.stop();else if(b==9&&this.options.tabMode!="default"&&!a.ctrlKey)this.handleTab(!a.shiftKey),a.stop();else if(b==32&&a.shiftKey&&this.options.tabMode=="default")this.handleTab(!0),a.stop();else if(b==36&&!a.shiftKey&&!a.ctrlKey)this.home()&&a.stop();else if(b==35&&!a.shiftKey&&!a.ctrlKey)this.end()&&a.stop();else if(b==33&&!a.shiftKey&&!a.ctrlKey&&!gecko)this.pageUp()&&a.stop();else if(b==34&&!a.shiftKey&&!a.ctrlKey&&!gecko)this.pageDown()&&
a.stop();else if((b==219||b==221)&&a.ctrlKey&&!a.altKey)this.highlightParens(a.shiftKey,!0),a.stop();else if(a.metaKey&&!a.shiftKey&&(b==37||b==39)){var d=select.selectionTopNode(this.container);d!==!1&&this.container.firstChild&&(b==37?select.focusAfterNode(e(d),this.container):(b=f(d,this.container),select.focusAfterNode(b?b.previousSibling:this.container.lastChild,this.container)),a.stop())}else if((a.ctrlKey||a.metaKey)&&!a.altKey)a.shiftKey&&b==90||b==89?(select.scrollToNode(this.history.redo()),
a.stop()):b==90||safari&&b==8?(select.scrollToNode(this.history.undo()),a.stop()):b==83&&this.options.saveFunction?(this.options.saveFunction(),a.stop()):b==86&&!mac&&this.reroutePasteEvent()}},keyPress:function(a){var b=this.options.electricChars&&l.Parser.electricChars,d=this;if(this.frozen&&(!this.keyFilter||this.keyFilter(a.keyCode||a.code,a))||a.code==13||a.code==9&&this.options.tabMode!="default"||a.code==32&&a.shiftKey&&this.options.tabMode=="default")a.stop();else if(mac&&(a.ctrlKey||a.metaKey)&&
a.character=="v")this.reroutePasteEvent();else if(b&&b.indexOf(a.character)!=-1)parent.setTimeout(function(){d.indentAtCursor(null)},0);else if(brokenOpera)if(a.code==8){var c=select.selectionTopNode(this.container),d=this,e=c?c.nextSibling:this.container.firstChild;c!==!1&&e&&isBR(e)&&parent.setTimeout(function(){select.selectionTopNode(d.container)==e&&select.focusAfterNode(e.previousSibling,d.container)},20)}else a.code==46&&(c=select.selectionTopNode(this.container),d=this,c&&isBR(c)&&parent.setTimeout(function(){select.selectionTopNode(d.container)!=
c&&select.focusAfterNode(c,d.container)},20));else if(slowWebkit&&(e=(c=select.selectionTopNode(this.container))?c.nextSibling:this.container.firstChild,c&&e&&isBR(e)&&!isBR(c))){var h=document.createTextNode("\u200b");this.container.insertBefore(h,e);parent.setTimeout(function(){h.nodeValue=="\u200b"?removeElement(h):h.nodeValue=h.nodeValue.replace("\u200b","")},20)}webkit&&!this.options.textWrapping&&setTimeout(function(){var a=select.selectionTopNode(d.container,!0);a&&a.nodeType==3&&a.previousSibling&&
isBR(a.previousSibling)&&a.nextSibling&&isBR(a.nextSibling)&&a.parentNode.replaceChild(document.createElement("BR"),a.previousSibling)},50)},keyUp:function(a){this.cursorActivity(a.keyCode>=16&&a.keyCode<=18||a.keyCode>=33&&a.keyCode<=40)},indentLineAfter:function(a,b){function d(a){a=a?a.nextSibling:c.container.firstChild;if(!a||!hasClass(a,"whitespace"))return null;return a}var c=this,f=d(a),h=0,i=f?f.currentText.length:0,g=f?f.nextSibling:a?a.nextSibling:this.container.firstChild;if(b=="keep"){if(a){var j=
d(e(a.previousSibling));if(j)h=j.currentText.length}}else j=a&&g&&g.currentText?g.currentText:"",b!=null&&this.options.tabMode!="indent"?h=b?i+indentUnit:Math.max(0,i-indentUnit):a?h=a.indentation(j,i,b,g):l.Parser.firstIndentation&&(h=l.Parser.firstIndentation(j,i,b,g));i=h-i;i<0?h==0?(g&&select.snapshotMove(f.firstChild,g.firstChild||g,0),removeElement(f),f=null):(select.snapshotMove(f.firstChild,f.firstChild,i,!0),f.currentText=makeWhiteSpace(h),f.firstChild.nodeValue=f.currentText):i>0?f?(f.currentText=
makeWhiteSpace(h),f.firstChild.nodeValue=f.currentText,select.snapshotMove(f.firstChild,f.firstChild,i,!0)):(f=makePartSpan(makeWhiteSpace(h)),f.className="whitespace",a?insertAfter(f,a):this.container.insertBefore(f,this.container.firstChild),select.snapshotMove(g&&(g.firstChild||g),f.firstChild,h,!1,!0)):f&&select.snapshotMove(f.firstChild,f.firstChild,h,!1);i!=0&&this.addDirtyNode(a)},highlightAtCursor:function(){var a=select.selectionTopNode(this.container,!0),b=select.selectionTopNode(this.container,
!1);if(a===!1||b===!1)return!1;select.markSelection();if(this.highlight(a,f(b,this.container),!0,20)===!1)return!1;select.selectMarked();return!0},handleTab:function(a){this.options.tabMode=="spaces"&&!select.somethingSelected()?select.insertTabAtCursor():this.reindentSelection(a)},home:function(){var a=select.selectionTopNode(this.container,!0),b=a;if(a===!1||a&&!a.isPart&&!isBR(a)||!this.container.firstChild)return!1;for(;a&&!isBR(a);)a=a.previousSibling;var d=a?a.nextSibling:this.container.firstChild;
d&&d!=b&&d.isPart&&hasClass(d,"whitespace")?select.focusAfterNode(d,this.container):select.focusAfterNode(a,this.container);select.scrollToCursor(this.container);return!0},end:function(){var a=select.selectionTopNode(this.container,!0);if(a===!1)return!1;a=f(a,this.container);if(!a)return!1;select.focusAfterNode(a.previousSibling,this.container);select.scrollToCursor(this.container);return!0},pageUp:function(){var a=this.cursorPosition().line,b=this.visibleLineCount();if(a===!1||b===!1)return!1;b-=
2;for(var d=0;d<b;d++)if(a=this.prevLine(a),a===!1)break;if(d==0)return!1;select.setCursorPos(this.container,{node:a,offset:0});select.scrollToCursor(this.container);return!0},pageDown:function(){var a=this.cursorPosition().line,b=this.visibleLineCount();if(a===!1||b===!1)return!1;b-=2;for(var d=0;d<b;d++){var c=this.nextLine(a);if(c===!1)break;a=c}if(d==0)return!1;select.setCursorPos(this.container,{node:a,offset:0});select.scrollToCursor(this.container);return!0},scheduleParenHighlight:function(){this.parenEvent&&
parent.clearTimeout(this.parenEvent);var a=this;this.parenEvent=parent.setTimeout(function(){a.highlightParens()},300)},highlightParens:function(a,b){function d(a,b){if(a)g?g.call?g(a,b):a.className+=" "+g[b?0:1]:(a.style.fontWeight="bold",a.style.color=b?"#8F8":"#F88")}function c(a){if(a)g&&!g.call?removeClass(removeClass(a,g[0]),g[1]):i.options.unmarkParen?i.options.unmarkParen(a):(a.style.fontWeight="",a.style.color="")}function e(a){if(a.currentText)return(a=a.currentText.match(/^[\s\u00a0]*([\(\)\[\]{}])[\s\u00a0]*$/))&&
a[1]}function h(){for(var a=[],b,d=!0,c=l;c;c=r?c.nextSibling:c.previousSibling)if(c.className==n&&isSpan(c)&&(b=e(c))){if(/[\(\[\{]/.test(b)==r?a.push(b):a.length?a.pop()!=matching[b]&&(d=!1):d=!1,!a.length)break}else if(c.dirty||!isSpan(c)&&!isBR(c))return{node:c,status:"dirty"};return{node:c,status:c&&d}}var i=this,g=this.options.markParen;typeof g=="string"&&(g=[g,g]);!b&&i.highlighted&&(c(i.highlighted[0]),c(i.highlighted[1]));if(window&&window.parent&&window.select){this.parenEvent&&parent.clearTimeout(this.parenEvent);
this.parenEvent=null;var j,l=select.selectionTopNode(this.container,!0);if(l&&this.highlightAtCursor()&&(l=select.selectionTopNode(this.container,!0))&&((j=e(l))||(l=l.nextSibling)&&(j=e(l))))for(var n=l.className,r=/[\(\[\{]/.test(j);;){var o=h();if(o.status=="dirty")this.highlight(o.node,f(o.node)),o.node.dirty=!1;else{d(l,o.status);d(o.node,o.status);b?parent.setTimeout(function(){c(l);c(o.node)},500):i.highlighted=[l,o.node];a&&o.node&&select.focusAfterNode(o.node.previousSibling,this.container);
break}}}},indentAtCursor:function(a){if(this.container.firstChild&&this.highlightAtCursor()){var b=select.selectionTopNode(this.container,!1);b!==!1&&(select.markSelection(),this.indentLineAfter(e(b),a),select.selectMarked())}},indentRegion:function(a,b,d,c){var g=a=e(a),h=a&&e(a.previousSibling);isBR(b)||(b=f(b,this.container));this.addDirtyNode(a);do{var i=f(g,this.container);g&&this.highlight(h,i,!0);this.indentLineAfter(g,d);h=g;g=i}while(g!=b);c&&select.setCursorPos(this.container,{node:a,offset:0},
{node:b,offset:0})},cursorActivity:function(a){if(this.unloaded)window.document.designMode="off",window.document.designMode="on",this.unloaded=!1;if(internetExplorer&&select.getBookmark){this.container.createTextRange().execCommand("unlink");clearTimeout(this.saveSelectionSnapshot);var b=this;this.saveSelectionSnapshot=setTimeout(function(){var a=select.getBookmark(b.container);if(a)b.selectionSnapshot=a},200)}var d=this.options.onCursorActivity;if(!a||d){var c=select.selectionTopNode(this.container,
!1);c!==!1&&this.container.firstChild&&(c=c||this.container.firstChild,d&&d(c),a||(this.scheduleHighlight(),this.addDirtyNode(c)))}},reparseBuffer:function(){forEach(this.container.childNodes,function(a){a.dirty=!0});this.container.firstChild&&this.addDirtyNode(this.container.firstChild)},addDirtyNode:function(a){if(a=a||this.container.firstChild){for(var b=0;b<this.dirty.length;b++)if(this.dirty[b]==a)return;if(a.nodeType!=3)a.dirty=!0;this.dirty.push(a)}},allClean:function(){return!this.dirty.length},
scheduleHighlight:function(){var a=this;parent.clearTimeout(this.highlightTimeout);this.highlightTimeout=parent.setTimeout(function(){a.highlightDirty()},this.options.passDelay)},getDirtyNode:function(){for(;this.dirty.length>0;){var a=this.dirty.pop();try{for(;a&&a.parentNode!=this.container;)a=a.parentNode;if(a&&(a.dirty||a.nodeType==3))return a}catch(b){}}return null},highlightDirty:function(a){if(!window||!window.parent||!window.select)return!1;this.options.readOnly||select.markSelection();for(var b,
d=a?null:(new Date).getTime()+this.options.passTime;((new Date).getTime()<d||a)&&(b=this.getDirtyNode());){var c=this.highlight(b,d);c&&c.node&&c.dirty&&this.addDirtyNode(c.node.nextSibling)}this.options.readOnly||select.selectMarked();b&&this.scheduleHighlight();return this.dirty.length==0},documentScanner:function(a){var b=this,d=null;return function(){if(window&&window.parent&&window.select){d&&d.parentNode!=b.container&&(d=null);select.markSelection();var c=b.highlight(d,(new Date).getTime()+
a,!0);select.selectMarked();c=c?c.node&&c.node.nextSibling:null;d=d==c?null:c;b.delayScanning()}}},delayScanning:function(){if(this.scanner)parent.clearTimeout(this.documentScan),this.documentScan=parent.setTimeout(this.scanner,this.options.continuousScanning)},highlight:function(a,b,d,c){function e(a){if(a){var b=a.oldNextSibling;(o||b===void 0||a.nextSibling!=b)&&f.history.touch(a);a.oldNextSibling=a.nextSibling}else b=f.container.oldFirstChild,(o||b===void 0||f.container.firstChild!=b)&&f.history.touch(null),
f.container.oldFirstChild=f.container.firstChild}var h=this.container,f=this,j=this.options.activeTokens,n=typeof b=="number"?b:null;if(!h.firstChild)return!1;for(;a&&(!a.parserFromHere||a.dirty);){if(c!=null&&isBR(a)&&--c<0)return!1;a=a.previousSibling}if(a&&!a.nextSibling)return!1;var q=g(a?a.nextSibling:h.firstChild),c=stringStream(q),v=a?a.parserFromHere(c):l.Parser.make(c),r={current:null,get:function(){if(!this.current)this.current=q.nodes.shift();return this.current},next:function(){this.current=
null},remove:function(){h.removeChild(this.get());this.current=null},getNonEmpty:function(){for(var a=this.get();a&&isSpan(a)&&a.currentText=="";)if(window.opera&&(a.previousSibling==null||isBR(a.previousSibling))&&(a.nextSibling==null||isBR(a.nextSibling)))this.next(),a=this.get();else{var b=a;this.remove();a=this.get();select.snapshotMove(b.firstChild,a&&(a.firstChild||a),0)}return a}},o=!1,E=!0,x=0;forEach(v,function(c){var g=r.getNonEmpty();if(c.value=="\n"){if(!isBR(g))throw"Parser out of sync. Expected BR.";
if(g.dirty||!g.indentation)o=!0;e(a);a=g;g.parserFromHere=v.copy();g.indentation=c.indentation||alwaysZero;g.dirty=!1;if(n==null&&g==b)throw StopIteration;if(n!=null&&(new Date).getTime()>=n||!o&&!E&&x>1&&!d)throw StopIteration;E=o;o=!1;x=0;r.next()}else{if(!isSpan(g))throw"Parser out of sync. Expected SPAN.";g.dirty&&(o=!0);x++;if(!g.reduced&&g.currentText==c.value&&g.className==c.style)j&&g.dirty&&j(g,c,f),g.dirty=!1,r.next();else{o=!0;var k=makePartSpan(c.value);k.className=c.style;h.insertBefore(k,
g);j&&j(k,c,f);for(var c=c.value.length,l=0;c>0;){var g=r.get(),q=g.currentText.length;select.snapshotReplaceNode(g.firstChild,k.firstChild,c,l);q>c?(g.currentText=g.currentText.substring(c),g.reduced=!0,c=0):(c-=q,l+=q,r.remove())}}}});e(a);webkitLastLineHack(this.container);return{node:r.getNonEmpty(),dirty:o}}};return l}();addEventHandler(window,"load",function(){var c=window.frameElement.CodeMirror;c.editor=new Editor(c.options);parent.setTimeout(method(c,"init"),0)});
function tokenizer(c,g){function e(c){return c!="\n"&&/^[\s\u00a0]*$/.test(c)}var f={state:g,take:function(f){typeof f=="string"&&(f={style:f,type:f});f.content=(f.content||"")+c.get();/\n$/.test(f.content)||c.nextWhile(e);f.value=f.content+c.get();return f},next:function(){if(!c.more())throw StopIteration;var g;if(c.equals("\n"))return c.next(),this.take("whitespace");if(c.applies(e))g="whitespace";else for(;!g;)g=this.state(c,function(c){f.state=c});return this.take(g)}};return f}
var tokenizeJavaScript=function(){function c(a,b){for(var c=!1;!a.endOfLine();){var e=a.next();if(e==b&&!c)return!1;c=!c&&e=="\\"}return c}function g(a,b){return function(c,f){var j=a,h=e(a,b,c,function(a){j=a}),i=h.type=="operator"||h.type=="keyword c"||h.type.match(/^[\[{}\(,;:]$/);(i!=b||j!=a)&&f(g(j,i));return h}}function e(a,b,d,e){function g(){d.nextWhileMatches(n);var a=d.get(),b=f.hasOwnProperty(a)&&f.propertyIsEnumerable(a)&&f[a];return b?{type:b.type,style:b.style,content:a}:{type:"variable",
style:"js-variable",content:a}}function h(a){for(var b="/*",a=a=="*";;){if(d.endOfLine())break;var c=d.next();if(c=="/"&&a){b=null;break}a=c=="*"}e(b);return{type:"comment",style:"js-comment"}}function i(){d.nextWhileMatches(j);return{type:"operator",style:"js-operator"}}function m(a){var b=c(d,a);e(b?a:null);return{type:"string",style:"js-string"}}if(a=='"'||a=="'")return m(a);var s=d.next();if(a=="/*")return h(s);else if(s=='"'||s=="'")return m(s);else if(/[\[\]{}\(\),;\:\.]/.test(s))return{type:s,
style:"js-punctuation"};else if(s=="0"&&(d.equals("x")||d.equals("X")))return d.next(),d.nextWhileMatches(l),{type:"number",style:"js-atom"};else if(/[0-9]/.test(s)){d.nextWhileMatches(/[0-9]/);d.equals(".")&&(d.next(),d.nextWhileMatches(/[0-9]/));if(d.equals("e")||d.equals("E"))d.next(),d.equals("-")&&d.next(),d.nextWhileMatches(/[0-9]/);return{type:"number",style:"js-atom"}}else return s=="/"?d.equals("*")?(d.next(),h(s)):d.equals("/")?(c(d,null),{type:"comment",style:"js-comment"}):(b?(c(d,"/"),
d.nextWhileMatches(/[gimy]/),a={type:"regexp",style:"js-string"}):a=i(),a):j.test(s)?i():g()}var f=function(){function a(a,b){return{type:a,style:"js-"+b}}var b=a("keyword a","keyword"),c=a("keyword b","keyword"),e=a("keyword c","keyword"),f=a("operator","keyword"),h=a("atom","atom");return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":e,"break":e,"continue":e,"new":e,"delete":e,"throw":e,"in":f,"typeof":f,"instanceof":f,"var":a("var","keyword"),"function":a("function","keyword"),
"catch":a("catch","keyword"),"for":a("for","keyword"),"switch":a("switch","keyword"),"case":a("case","keyword"),"default":a("default","keyword"),"true":h,"false":h,"null":h,undefined:h,NaN:h,Infinity:h}}(),j=/[+\-*&%=<>!?|]/,l=/[0-9A-Fa-f]/,n=/[\w\$_]/;return function(a,b){return tokenizer(a,b||g(!1,!0))}}(),JSParser=Editor.Parser=function(){function c(c,e,f,a,b,d){this.indented=c;this.column=e;this.type=f;if(a!=null)this.align=a;this.prev=b;this.info=d}function g(c){return function(e){var f=e&&e.charAt(0),
a=c.type,b=f==a;return a=="vardef"?c.indented+4:a=="form"&&f=="{"?c.indented:a=="stat"||a=="form"?c.indented+indentUnit:c.info=="switch"&&!b?c.indented+(/^(?:case|default)\b/.test(e)?indentUnit:2*indentUnit):c.align?c.column-(b?1:0):c.indented+(b?0:indentUnit)}}var e={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},f=!1;return{make:function(j,l){function n(a){for(var b=a.length-1;b>=0;b--)D.push(a[b])}function a(){n(arguments);L=!0}function b(){n(arguments);L=!1}function d(){y={prev:y,vars:{"this":!0,
arguments:!0}}}function k(){y=y.prev}function p(a){y&&(I="js-variabledef",y.vars[a]=!0)}function h(a,b){var d=function(){w=new c(K,J,a,null,w,b)};d.lex=!0;return d}function i(){if(w.type==")")K=w.indented;w=w.prev}function m(c){return function(d){d==c?a():c==";"?b():a(arguments.callee)}}function s(){return b(v,s)}function q(){return b(r,q)}function v(c){c=="var"?a(h("vardef"),C,m(";"),i):c=="keyword a"?a(h("form"),r,v,i):c=="keyword b"?a(h("form"),v,i):c=="{"?a(h("}"),B,i):c==";"?a():c=="function"?
a(M):c=="for"?a(h("form"),m("("),h(")"),u,m(")"),i,v,i):c=="variable"?a(h("stat"),E):c=="switch"?a(h("form"),r,h("}","switch"),m("{"),B,i,i):c=="case"?a(r,m(":")):c=="default"?a(m(":")):c=="catch"?a(h("form"),d,m("("),N,m(")"),v,i,k):b(h("stat"),r,m(";"),i)}function r(b){e.hasOwnProperty(b)?a(o):b=="function"?a(M):b=="keyword c"?a(r):b=="("?a(h(")"),r,m(")"),i,o):b=="operator"?a(r):b=="["?a(h("]"),A(r,"]"),i,o):b=="{"?a(h("}"),A(t,"}"),i,o):a()}function o(c,d){c=="operator"&&/\+\+|--/.test(d)?a(o):
c=="operator"?a(r):c==";"?b():c=="("?a(h(")"),A(r,")"),i,o):c=="."?a(x,o):c=="["&&a(h("]"),r,m("]"),i,o)}function E(c){c==":"?a(i,v):b(o,m(";"),i)}function x(b){b=="variable"&&(I="js-property",a())}function t(b){b=="variable"&&(I="js-property");e.hasOwnProperty(b)&&a(m(":"),r)}function A(c,d){function e(b){b==","?a(c,e):b==d?a():a(m(d))}return function(f){f==d?a():b(c,e)}}function B(c){c=="}"?a():b(v,B)}function C(b,c){b=="variable"?(p(c),a(F)):a()}function F(b,c){c=="="?a(r,F):b==","&&a(C)}function u(c){c==
"var"?a(C,H):c==";"?b(H):c=="variable"?a(G):b(H)}function G(b,c){c=="in"?a(r):a(o,H)}function H(b,c){b==";"?a(O):c=="in"?a(r):a(r,m(";"),O)}function O(c){c==")"?b():a(r)}function M(b,c){b=="variable"?(p(c),a(M)):b=="("&&a(h(")"),d,A(N,")"),i,v,k)}function N(b,c){b=="variable"&&(p(c),a())}var z=tokenizeJavaScript(j),D=[f?q:s],y=null,w=new c((l||0)-indentUnit,0,"block",!1),J=0,K=0,L,I,P={next:function(){for(;D[D.length-1].lex;)D.pop()();var a=z.next();if(a.type=="whitespace"&&J==0)K=a.value.length;
J+=a.value.length;if(a.content=="\n"){K=J=0;if(!("align"in w))w.align=!1;a.indentation=g(w)}if(a.type=="whitespace"||a.type=="comment")return a;if(!("align"in w))w.align=!0;for(;;)if(L=I=!1,D.pop()(a.type,a.content),L){if(I)a.style=I;else{var b;if(b=a.type=="variable")a:{for(b=y;b;){if(b.vars[a.content]){b=!0;break a}b=b.prev}b=!1}if(b)a.style="js-localvariable"}return a}},copy:function(){var a=y,b=w,c=D.concat([]),d=z.state;return function(e){y=a;w=b;D=c.concat([]);J=K=0;z=tokenizeJavaScript(e,d);
return P}}};i.lex=!0;return P},electricChars:"{}:",configure:function(c){if(c.json!=null)f=c.json}}}(),XMLParser=Editor.Parser=function(){var c={autoSelfClosers:{br:!0,img:!0,hr:!0,link:!0,input:!0,meta:!0,col:!0,frame:!0,base:!0,area:!0},doNotIndent:{pre:!0,"!cdata":!0}},g={autoSelfClosers:{},doNotIndent:{"!cdata":!0}},e=c,f=!1,j=function(){function c(a,f){var g=a.next();if(g=="<")return a.equals("!")?(a.next(),a.equals("[")?a.lookAhead("[CDATA[",!0)?(f(b("xml-cdata","]]\>")),null):"xml-text":a.lookAhead("--",
!0)?(f(b("xml-comment","--\>")),null):a.lookAhead("DOCTYPE",!0)?(a.nextWhileMatches(/[\w\._\-]/),f(b("xml-doctype",">")),"xml-doctype"):"xml-text"):a.equals("?")?(a.next(),a.nextWhileMatches(/[\w\._\-]/),f(b("xml-processing","?>")),"xml-processing"):(a.equals("/")&&a.next(),f(e),"xml-punctuation");else if(g=="&"){for(;!a.endOfLine();)if(a.next()==";")break;return"xml-entity"}else return a.nextWhileMatches(/[^&<\n]/),"xml-text"}function e(b,f){var g=b.next();return g==">"?(f(c),"xml-punctuation"):
/[?\/]/.test(g)&&b.equals(">")?(b.next(),f(c),"xml-punctuation"):g=="="?"xml-punctuation":/[\'\"]/.test(g)?(f(a(g)),null):(b.nextWhileMatches(/[^\s\u00a0=<>\"\'\/?]/),"xml-name")}function a(a){return function(b,c){for(;!b.endOfLine();)if(b.next()==a){c(e);break}return"xml-attribute"}}function b(a,b){return function(e,f){for(;!e.endOfLine();){if(e.lookAhead(b,!0)){f(c);break}e.next()}return a}}return function(a,b){return tokenizer(a,b||c)}}();return{make:function(c){function g(a){for(var b=a.length-
1;b>=0;b--)A.push(a[b])}function a(){g(arguments);G=!0}function b(){g(arguments);G=!1}function d(){t.style+=" xml-error"}function k(b){return function(c,e){e==b?a():(d(),a(arguments.callee))}}function p(a,b){var c=e.doNotIndent.hasOwnProperty(a)||u&&u.noIndent;u={prev:u,name:a,indent:C,startOfLine:b,noIndent:c}}function h(a){return function(b,c){var d=a;if(d&&d.noIndent)return c;if(f&&/<!\[CDATA\[/.test(b))return 0;if(d&&/^<\//.test(b))d=d.prev;for(;d&&!d.startOfLine;)d=d.prev;return d?d.indent+indentUnit:
0}}function i(){return b(m,i)}function m(b,c){if(c=="<")a(s,r,v(B==1));else if(c=="</")a(q,k(">"));else{if(b=="xml-cdata"){if((!u||u.name!="!cdata")&&p("!cdata"),/\]\]>$/.test(c))u=u.prev}else H.hasOwnProperty(b)||d();a()}}function s(c,d){c=="xml-name"?(F=d.toLowerCase(),t.style="xml-tagname",a()):(F=null,b())}function q(b,c){if(b=="xml-name")t.style="xml-tagname",u&&c.toLowerCase()==u.name?u=u.prev:d();a()}function v(b){return function(c,f){f=="/>"||f==">"&&e.autoSelfClosers.hasOwnProperty(F)?a():
f==">"?(p(F,b),a()):(d(),a(arguments.callee))}}function r(c){c=="xml-name"?(t.style="xml-attname",a(o,r)):b()}function o(c,d){d=="="?a(E):d==">"||d=="/>"?b(v):b()}function E(c){c=="xml-attribute"?a(E):b()}var x=j(c),t,A=[i],B=0,C=0,F=null,u=null,G,H={"xml-text":!0,"xml-entity":!0,"xml-comment":!0,"xml-processing":!0,"xml-doctype":!0};return{indentation:function(){return C},next:function(){t=x.next();t.style=="whitespace"&&B==0?C=t.value.length:B++;if(t.content=="\n")C=B=0,t.indentation=h(u);if(t.style==
"whitespace"||t.type=="xml-comment")return t;for(;;)if(G=!1,A.pop()(t.style,t.content),G)return t},copy:function(){var a=A.concat([]),b=x.state,c=u,d=this;return function(e){A=a.concat([]);B=C=0;u=c;x=j(e,b);return d}}}},electricChars:"/",configure:function(j){j.useHTMLKludges!=null&&(e=j.useHTMLKludges?c:g);if(j.alignCDATA)f=j.alignCDATA}}}(),CSSParser=Editor.Parser=function(){function c(c,f,g){return function(l){return!c||/^\}/.test(l)?g:f?g+indentUnit*2:g+indentUnit}}var g=function(){function c(e,
a){var b=e.next();return b=="@"?(e.nextWhileMatches(/\w/),"css-at"):b=="/"&&e.equals("*")?(a(f),null):b=="<"&&e.equals("!")?(a(g),null):b=="="?"css-compare":e.equals("=")&&(b=="~"||b=="|")?(e.next(),"css-compare"):b=='"'||b=="'"?(a(l(b)),null):b=="#"?(e.nextWhileMatches(/\w/),"css-hash"):b=="!"?(e.nextWhileMatches(/[ \t]/),e.nextWhileMatches(/\w/),"css-important"):/\d/.test(b)?(e.nextWhileMatches(/[\w.%]/),"css-unit"):/[,.+>*\/]/.test(b)?"css-select-op":/[;{}:\[\]]/.test(b)?"css-punctuation":(e.nextWhileMatches(/[\w\\\-_]/),
"css-identifier")}function f(f,a){for(var b=!1;!f.endOfLine();){var d=f.next();if(b&&d=="/"){a(c);break}b=d=="*"}return"css-comment"}function g(f,a){for(var b=0;!f.endOfLine();){var d=f.next();if(b>=2&&d==">"){a(c);break}b=d=="-"?b+1:0}return"css-comment"}function l(f){return function(a,b){for(var d=!1;!a.endOfLine();){var g=a.next();if(g==f&&!d)break;d=!d&&g=="\\"}d||b(c);return"css-string"}}return function(f,a){return tokenizer(f,a||c)}}();return{make:function(e,f){var f=f||0,j=g(e),l=!1,n=!1,a=
!1,b={next:function(){var b=j.next(),e=b.style,g=b.content;if(e=="css-hash")e=b.style=n?"css-colorcode":"css-identifier";if(e=="css-identifier")if(n)b.style="css-value";else if(!l&&!a)b.style="css-selector";if(g=="\n")b.indentation=c(l,n,f);g=="{"&&a=="@media"?a=!1:g=="{"?l=!0:g=="}"?l=n=a=!1:g==";"?n=a=!1:l&&e!="css-comment"&&e!="whitespace"?n=!0:!l&&e=="css-at"&&(a=g);return b},copy:function(){var a=l,c=n,e=j.state;return function(f){j=g(f,e);l=a;n=c;return b}}};return b},electricChars:"}"}}(),
HTMLMixedParser=Editor.Parser=function(){function c(){var c=["XMLParser"],f;for(f in g)c.push(g[f]);for(var j in c)if(!window[c[j]])throw Error(c[j]+" parser must be loaded for HTML mixed mode to work.");XMLParser.configure({useHTMLKludges:!0})}var g={script:"JSParser",style:"CSSParser"};return{make:function(e){function f(){var c=l.next();if(c.content=="<")a=!0;else if(c.style=="xml-tagname"&&a===!0)a=c.content.toLowerCase();else if(c.content==">"){if(g[a])b.next=j(window[g[a]],"</"+a);a=!1}return c}
function j(a,c){var g=l.indentation();n=a.make(e,g+indentUnit);return function(){if(e.lookAhead(c,!1,!1,!0))return n=null,b.next=f,f();var a=n.next(),d=a.value.lastIndexOf("<"),j=Math.min(a.value.length-d,c.length);if(d!=-1&&a.value.slice(d,d+j).toLowerCase()==c.slice(0,j)&&e.lookAhead(c.slice(j),!1,!1,!0))e.push(a.value.slice(d)),a.value=a.value.slice(0,d);if(a.indentation){var l=a.indentation;a.indentation=function(a){return a=="</"?g:l(a)}}return a}}c();var l=XMLParser.make(e),n=null,a=!1,b={next:f,
copy:function(){var c=l.copy(),f=n&&n.copy(),g=b.next,h=a;return function(i){e=i;l=c(i);n=f&&f(i);b.next=g;a=h;return b}}};return b},electricChars:"{}/:",configure:function(c){if(c.triggers)g=c.triggers}}}();